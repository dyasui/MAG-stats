{"title":"2024 US Men's Gymnastics Olympic Team Selection","markdown":{"yaml":{"title":"2024 US Men's Gymnastics Olympic Team Selection","author":"Dante Yasui","date":"2024/06/29","format":{"html":{"df-print":"kable","toc":true}}},"headingText":"TODO","containsRefs":false,"markdown":"\n\n\n- Calculate what the other top team compositions were\n  - [x] apply [@lst-functions] to each possible team combo \n  and select the max scoring team based on the averages in [@lst-data]\n- [x] visualize the relative strengths of the team by comparing against distributions in [@fig-eventdist]\n- [ ] compare to similar scores of other national teams\n- [ ] make events print in olympic order, not alphabetic\n- [ ] calculate each team members contribution by picking best team \nwhen they are dropped from results dataset\n\n---\n\n# Data\n\nI copied the data from <https://myusagym.com>\nand manually cleaned it up into `.csv` format.\n\n```{r}\n#| message: FALSE\n#| lst-label: lst-data\n#| lst-cap: combining data from nationals and trials\nlibrary(tidyverse)\n# read all results across usa champs and olympic trials\nnc1_df <- read_csv(\"./natnls-d1.csv\")\nnc2_df <- read_csv(\"./natnls-d2.csv\")\not1_df <- read_csv(\"./trials-day1.csv\")\not2_df <- read_csv(\"./trials-day2.csv\")\n# merge all results into one dataframe\nresults_df <- bind_rows(list(nc1_df, nc2_df, ot1_df, ot2_df))\n```\n\nTo visualize the data overall, \nI grouped scores by event from all USA Championships and Olympic Trials \nroutines and plotted the spread of observed scores.\n\n```{r}\n#| label: fig-eventdist\n#| fig-cap: national distributions of scores on each event\n#| lst-label: lst-eventdist\n#| lst-cap: plot of event distributions\nlibrary(ggthemes)\neventsdist <- results_df %>% select(!AA) %>%\n  pivot_longer(\n    cols = c(FX, PH, SR, VT, PB, HB),\n    names_to = \"Event\",\n    values_to = \"Score\",\n  ) %>% filter(Score > 1) %>%\n  ggplot(aes(x=Score)) +\n  geom_density() +\n  xlim(11, 16) +\n  facet_wrap(~Event, ncol = 2) +\n  theme_pander()\neventsdist\n```\n\nNot surprisingly, out of all six event Pommel has the largest variance in\nscores and the lowest average.\nP-Bars and Vault are high-scoring events on average but Vault \n(at least for these competitions) is more consistently grouped around 14\nwhile the P-Bars distribution seem to have a large right tail \nwith a lot of potential for 15+ scores.\n\n## Averages across usa championships and olympic trials\n\n```{r}\n#| label: tbl-averagescores\n#| tbl-cap: \"Individuals' average scores across nationals and trials\"\n# average individual gymnasts' scores across four days\nindv.averages_df <- results_df %>% \n  filter(NAME %in% ot1_df$NAME) %>%  # who qualified to olympic trials \n  group_by(NAME) %>% \n  summarise_at(vars(FX:AA), mean, na.rm=TRUE) %>% \n  arrange(desc(AA))\nindv.averages_df\n```\n\n---\n\n## Predicting a Team's performance\n```{r}\n#| lst-label: lst-functions\n#| lst-cap: functions for calculating team performance\n\n# function to pick top three scores on each event from a team\nteam_top_scores <- function(names, scores = indv.averages_df, perevent = 3) {\n  scores %>% \n    filter(NAME %in% names) %>%\n    select(-AA) %>% \n    pivot_longer(\n      -NAME,\n      names_to = \"Event\",\n      values_to = \"Score\",\n    ) %>% \n    # take top 3 on each event dropping extra tied scores\n    group_by(Event) %>% \n    slice_max(n = perevent, order_by = Score, with_ties = FALSE) %>% \n    mutate(\n      teamscore = sum(Score),\n      # names     = c(unique(NAME))\n      )  %>%\n    group_by(Event) %>% \n    summarise(\n      Score   = first(teamscore),\n      OnEvent = list((NAME))\n      ) %>% ungroup()\n}\n\n# function to take output of select_top_scores and calculate total\nteam_total <- function(top_scores) {\n  top_scores %>% \n    summarise(x=sum(Score)) %>% \n    pull()\n}\n\n```\n\nThis method assumes that scores earned at the USA Championships and Olympic\nTrials are accurate predictions of scores earned at the actual Olympics.\nThese will be over-estimates of a potential team's Olympic performance if the \ndomestic judging is less strict than the Olympic Committee judges panels.\n\nMy code also implicitly uses a 5-up, 3-count scoring system which is different\nfrom the actual 3-up, 3-count rule during Olympic team finals.\nWhile the US might choose the lineup in this way, they will also probably \nhave to take into account the health of their athletes\n(e.g., resting Brody's leg by not having him vault).\n\n# Team USA's expected performance\n\n## Event scores breakdown\n```{r}\n#| label: tbl-teamevents\n#| tbl-cap: \"Team USA expected event scores\"\n#| lst-label: lst-actualteam\n#| lst-cap: team_top_scores() of actual team picks\nteam_names <- c(\"Brody Malone\", \"Fred Richard\", \"Asher Hong\", \"Paul Juda\",\n                \"Stephen Nedoroscik\")\nactual_team <- team_top_scores(team_names)\nactual_team_tot <- actual_team %>% \n  team_total()\nactual_team\n```\n\n### Interpreting the team's average scores\n\nThe expected team score for this team ^[with domestic judging]\nis `r actual_team_tot`.\nFor some context, the gold medal Japanese team at 2023 world championships\n^[according to the [wikipedia page](https://en.m.wikipedia.org/wiki/2023_World_Artistic_Gymnastics_Championships)]\nscored 255.594 and USA won bronze at the same competition with 252.428.\n\nOn paper this teams strengths relative to international competition seem to be\nFloor, Pommel, and High Bar with scores of \n`r actual_team %>% filter(Event==\"FX\") %>% pull(Score)`,\n`r actual_team %>% filter(Event==\"PH\") %>% pull(Score)`, and\n`r actual_team %>% filter(Event==\"HB\") %>% pull(Score)`,\nrespectively.\nHowever, the US is pretty infamous for not being able to pull together their \nfull potential on Pommel.\n\nThis team also remains competitive on  Rings with an average score of \n`r actual_team %>% filter(Event==\"SR\") %>% pull(Score)`\nand on P-Bars with a\n`r actual_team %>% filter(Event==\"PB\") %>% pull(Score)`.\nWith China being so dominant on those two events they probably won't win any\nevent final medals there but having those two events as strengths will definitely help the team score against Japan and Great Britain.\n\nIt's kind of surprising that the main weakness on paper of this team is vault.\nWith Brody, Paul, and Asher vaulting at a total predicted score of \n`r actual_team %>% filter(Event==\"VT\") %>% pull(Score)`,\nthey fall behind both China's and Great Britain's scores as well as the \nprevious US team's own score on the event from last year.\nI heard that judging on Asher's Ri Se Gwang vault seemed overly harsh,\nso it's possible that this team vault score gets better,\nbut I think he's the only one with a D-score higher than 5.6 on this event.\n\n### Potential vs Expectations\n\nThere will also be more psychological strain on these athletes which comes with\nthe media attention and unfamiliar setting in Paris.\nThis could be a factor that could potentially affect this team more than other\nalternative US teams.\n\nI was hoping that Yul Muldauer could provide the same kind of leadership\nhe showed at the World Championships to a younger and less-internationally \nexperienced team.\nUnfortunately he didn't perform up to his usual level of execution and \nconsistency in these past few competitions so I understand why he was left off.\nThese five guys (with maybe the exception of Paul?) have experience competing\nat the World/Olympic level, but I think Yul is one of those guys who gets along\nwith everyone and feels comfortable in the spotlight.\nI think Fred has a very similar enthusiasm and drive, but this is still only \nhis second year of competing at the senior international level.\n\nThe first night of the Olympic Trials made me pretty nervous about the \nability for US gymnasts to stay consistent with increased attention on them.\nIt was great to see how full the stadium in Minneapolis was for men's gymnastics,\nbut I also thought that some of the extra shakiness on Pommel and throughout the night might have been attributable to all the extra energy around.\nThis team has a lot of potential and I just hope that they don't get \noverwhelmed by the pressure of thinking that they need to live up to the \nhigh expectations of a domestic audience who only tune in every four years\nwith the anticipation that anything team USA touches at the Olympics could turn to gold.\n\n### Comparing to the rest of the field\n\n```{r}\n#| warning: false\n#| label: fig-eventdist_team\n#| fig-cap: \"Olympic team's scores relative to everyone else\"\nteam_scores <- indv.averages_df %>% \n    filter(NAME %in% team_names) %>%\n    select(-AA) %>% \n    pivot_longer(\n      -NAME,\n      names_to = \"Event\",\n      values_to = \"Score\",\n    )\neventsdist +\n  geom_vline(\n    data = team_scores, \n    aes(\n      xintercept = Score, \n      color = Score,\n      ),\n      linetype = \"dashed\"\n    ) +\n  geom_text(\n    data = team_scores, \n    aes(\n      y = 0.4,\n      x = Score,\n      label = NAME,\n      color = Score\n      ),\n    angle = 270,\n    size = 2,\n    nudge_x = 0.05,\n    ) +\n  scale_color_viridis_c(option = \"turbo\", direction = -1) +\n  xlim(12, 15)\n```\n\n---\n\n# Team Selection Analysis\n```{r}\n#| eval: false\n#| label: sim_results\n\nnames <- indv.averages_df %>% select(NAME) %>% pull()\n\n# all combinations of gymnasts choosing five at a time\nteams_possible <- combinat::combn(names, 5, simplify = T) %>% \n  as_tibble() %>% \n  pivot_longer(\n    cols = everything(),\n    names_to = \"team\",\n    values_to = \"name\") %>% \n  group_by(team) %>% \n  summarise(\n    names = list(name)\n  )\n\n# function to apply team_total to list of names\nteam_top_total <- function(x) team_total(team_top_scores(unlist(x)))\n\n# record top scores for every possible team combination\nteamsim_df <- teams_possible %>% \n  mutate(\n    total = as.numeric(map(names, team_top_total)),\n    # names = map(names, toString)\n  ) %>% \n  arrange(desc(total))\n\n# save sim results to file\nsave(teamsim_df, file = \"teamsim.RData\")\n```\n\n```{r specialist_rule}\nspecialist_rule <- function(teams, individuals) {\n  specialists <- individuals %>% \n    filter(is.na(AA)) %>% \n    select(NAME) %>% \n    pull()\n  teams %>% \n    filter(\n      str_count(.$names, paste(specialists, collapse='|')) < 2\n    )\n}\n```\n\n\n```{r}\n#| label: tbl-topteams\n#| tbl-cap: \"Top ten scoring teams on average\"\nload(\"./teamsim.RData\")\nteamsim_df %>% \n  select(-team) %>% \n  filter(str_detect(.$names, \"Patrick Hoopes\", negate = T)) %>% \n  specialist_rule(individuals = indv.averages_df) %>% \n  head(n=10)\n```\n\nIt's not surprising that Brody and Fred show up on all of these teams.\nAsher is also pretty dominant in this ranking, which seems to be coming from his\nhigher performances on rings and p-bars compared to Donnell and being close\nenough to Khoi on vault and floor.\n\nThe top team of all all-arounders just swaps out Stephen for Shane \nand scores more than a point lower.\nInteresting that Yul has a better all-around average than Asher, \nand yet he wouldn't actually the better pick in an all all-arounder team.\nA lot of these teams are just variations of the same teams except swapping \nStephen and Patrick Hoopes.\nBecause Stephen had a higher four-score average and potential difficulty \nthan Patrick, I drop Patrick from the list to get a sense of some more \nrealistic alternate team selections.\n\nThis also highlights how close Shane came to being on the team (by just .75)! \nBut it also how similar his contributions are to Paul's which sort of put him\nin the same unfortunate position as Patrick Hoopes who's status as a pommel \nspecialist means that he can only really be swapped out with Stephen.\n\n### Importance of Pommel Horse Specialists\n\nOne thing I didn't expect before seeing these simulated teams\nis that almost all of these top 20 teams have at least one pommel specialist\n(before I dropped Patrick).\n\n```{r}\n#| echo: true\nPH_actual_team <- actual_team %>% filter(Event==\"PH\") %>% \n  select(Score) %>% pull()\nPH_second_best <- indv.averages_df %>% \n  filter(!is.na(AA)) %>% \n  select(NAME, PH) %>% \n  slice_max(order_by = PH, n = 3)\nPH_second_best\n```\n\n```{r}\n#| echo: false\nPH_second_best_score <- PH_second_best %>% \n  summarise(x = sum(PH)) %>% \n  pull()\n```\n\nWithout sending a pommel horse specialist to Paris, \nthe best possible team score USA could put up on this event would be \n`r PH_second_best_score`.\nSo Stephen is contributing at least an extra \n`r PH_actual_team - PH_second_best_score` points to the team score\nand likely more considering that he's making sure Fred's 13.3 PH average \nwon't have to be counted. \n\n```{r}\n#| echo: false\npull_score <- function(scores, name, event) {\n  scores %>% \n    filter(NAME == name) %>% \n    select(event) %>% \n    pull()\n}\n```\n\nIf Khoi had hit his pommel routines consistently then he would have seemed\nlike a much more obvious replacement for Stephen because he has the potential\nto put up a 15.0 like he showed in night 2 of US Championships.\nHe would also make the team's vault score a lot more competitive where his \naverage score of \n`r pull_score(indv.averages_df, \"Khoi Young\", \"VT\")` is actually \n`r round(pull_score(indv.averages_df, \"Khoi Young\", \"VT\") - pull_score(indv.averages_df, \"Asher Hong\", \"VT\"), 1)*10`\ntenths higher than Asher's and seems to be a lot more consistent.\n\n# Other hypothetical compositions\n\n### Picking only the top all-arounders\n```{r}\n#| label: tbl-altteam1events\n#| tbl-cap: \"Top 5 all-arounders team event scores\"\n# If they had taken top five all arounders\nalt_team1_names <- indv.averages_df %>% \n  slice_head(n=5) %>% \n  select(NAME) %>% \n  pull()\nalt_team1 <- team_top_scores(alt_team1_names)\nalt_team1\n```\n\nThis team has an expected score of `r team_total(alt_team1)` \nwhich is `r round(actual_team_tot - team_total(alt_team1), digits=1)` points \nbehind the selected team's expected score,\nso it makes sense they didn't go with this team.\nPaul and Shane are both similar in that their main strengths are contributing \nsolid performances on any event but neither have any standout routines with\nenough difficulty to put them in event finals. \nIt makes sense to have one gymnast fill this roll on a team, \nbut I don't think it makes sense to leave behind world-class routines like \nStephen's pommel horse or Asher's, Khoi's, or Donnell's vaults to gain\nthe additional safe scores from sending both Paul and Shane together.\n\nIt was really cool to see how hyped the Minneapolis crowd was to see \nshane compete in his hometown and he did a great job over the two nights there,\nbut ultimately Paul just put on a more consistent performance during \nUS Championships. \nAnd that's what this type of role on team USA is all about;\njust proving that you will put up a decent score every time you go up.\n\n### My team picks\n```{r}\n#| label: tbl-altteam2events\n#| tbl-cap: \"My custom team's event breakdown\"\n# My own personal picks\nalt_team2_names <- c(\"Fred Richard\", \"Brody Malone\", \"Yul Moldauer\", \"Donnell Whittenburg\", \"Khoi Young\")\nalt_team2 <- team_top_scores(alt_team2_names)\nalt_team2\n```\n\nThis team falls short by `r round(actual_team_tot - team_total(alt_team2), 1)` points\nalthough I think they would have more opporunities to make event finals \non Floor, P-Bars, and Vault.\nGiven Donnell's vs Asher's performances over Nationals and Trials,\nit probably makes more sense to have Asher \nbut I think Donnell has more international experience \nand I also just really wanted to see him get to represent USA at the Olympics\nafter working so hard for his entire career and not really getting that much recognition.\n\n### Using Maximum Scores instead of Averages\n\n```{r}\nindv.max_df <- results_df %>% \n  filter(NAME %in% ot1_df$NAME) %>%  # who qualified to olympic trials \n  group_by(NAME) %>% \n  summarise_at(vars(FX:AA), max, na.rm=TRUE) %>% \n  arrange(desc(AA))\n\nteam_max_total <- function(x) team_total(team_top_scores(unlist(x), scores = indv.max_df))\n\n# record top scores for every possible team combination using individual max's\nteamsim_df <- teams_possible %>% \n  mutate(\n    total = as.numeric(map(names, team_max_total)),\n    # names = map(names, toString)\n  ) %>% \n  arrange(desc(total))\n\nteam_top_scores(teams_possible, scores = indv.max_df)\n```\n\n","srcMarkdownNoYaml":"\n\n# TODO\n\n- Calculate what the other top team compositions were\n  - [x] apply [@lst-functions] to each possible team combo \n  and select the max scoring team based on the averages in [@lst-data]\n- [x] visualize the relative strengths of the team by comparing against distributions in [@fig-eventdist]\n- [ ] compare to similar scores of other national teams\n- [ ] make events print in olympic order, not alphabetic\n- [ ] calculate each team members contribution by picking best team \nwhen they are dropped from results dataset\n\n---\n\n# Data\n\nI copied the data from <https://myusagym.com>\nand manually cleaned it up into `.csv` format.\n\n```{r}\n#| message: FALSE\n#| lst-label: lst-data\n#| lst-cap: combining data from nationals and trials\nlibrary(tidyverse)\n# read all results across usa champs and olympic trials\nnc1_df <- read_csv(\"./natnls-d1.csv\")\nnc2_df <- read_csv(\"./natnls-d2.csv\")\not1_df <- read_csv(\"./trials-day1.csv\")\not2_df <- read_csv(\"./trials-day2.csv\")\n# merge all results into one dataframe\nresults_df <- bind_rows(list(nc1_df, nc2_df, ot1_df, ot2_df))\n```\n\nTo visualize the data overall, \nI grouped scores by event from all USA Championships and Olympic Trials \nroutines and plotted the spread of observed scores.\n\n```{r}\n#| label: fig-eventdist\n#| fig-cap: national distributions of scores on each event\n#| lst-label: lst-eventdist\n#| lst-cap: plot of event distributions\nlibrary(ggthemes)\neventsdist <- results_df %>% select(!AA) %>%\n  pivot_longer(\n    cols = c(FX, PH, SR, VT, PB, HB),\n    names_to = \"Event\",\n    values_to = \"Score\",\n  ) %>% filter(Score > 1) %>%\n  ggplot(aes(x=Score)) +\n  geom_density() +\n  xlim(11, 16) +\n  facet_wrap(~Event, ncol = 2) +\n  theme_pander()\neventsdist\n```\n\nNot surprisingly, out of all six event Pommel has the largest variance in\nscores and the lowest average.\nP-Bars and Vault are high-scoring events on average but Vault \n(at least for these competitions) is more consistently grouped around 14\nwhile the P-Bars distribution seem to have a large right tail \nwith a lot of potential for 15+ scores.\n\n## Averages across usa championships and olympic trials\n\n```{r}\n#| label: tbl-averagescores\n#| tbl-cap: \"Individuals' average scores across nationals and trials\"\n# average individual gymnasts' scores across four days\nindv.averages_df <- results_df %>% \n  filter(NAME %in% ot1_df$NAME) %>%  # who qualified to olympic trials \n  group_by(NAME) %>% \n  summarise_at(vars(FX:AA), mean, na.rm=TRUE) %>% \n  arrange(desc(AA))\nindv.averages_df\n```\n\n---\n\n## Predicting a Team's performance\n```{r}\n#| lst-label: lst-functions\n#| lst-cap: functions for calculating team performance\n\n# function to pick top three scores on each event from a team\nteam_top_scores <- function(names, scores = indv.averages_df, perevent = 3) {\n  scores %>% \n    filter(NAME %in% names) %>%\n    select(-AA) %>% \n    pivot_longer(\n      -NAME,\n      names_to = \"Event\",\n      values_to = \"Score\",\n    ) %>% \n    # take top 3 on each event dropping extra tied scores\n    group_by(Event) %>% \n    slice_max(n = perevent, order_by = Score, with_ties = FALSE) %>% \n    mutate(\n      teamscore = sum(Score),\n      # names     = c(unique(NAME))\n      )  %>%\n    group_by(Event) %>% \n    summarise(\n      Score   = first(teamscore),\n      OnEvent = list((NAME))\n      ) %>% ungroup()\n}\n\n# function to take output of select_top_scores and calculate total\nteam_total <- function(top_scores) {\n  top_scores %>% \n    summarise(x=sum(Score)) %>% \n    pull()\n}\n\n```\n\nThis method assumes that scores earned at the USA Championships and Olympic\nTrials are accurate predictions of scores earned at the actual Olympics.\nThese will be over-estimates of a potential team's Olympic performance if the \ndomestic judging is less strict than the Olympic Committee judges panels.\n\nMy code also implicitly uses a 5-up, 3-count scoring system which is different\nfrom the actual 3-up, 3-count rule during Olympic team finals.\nWhile the US might choose the lineup in this way, they will also probably \nhave to take into account the health of their athletes\n(e.g., resting Brody's leg by not having him vault).\n\n# Team USA's expected performance\n\n## Event scores breakdown\n```{r}\n#| label: tbl-teamevents\n#| tbl-cap: \"Team USA expected event scores\"\n#| lst-label: lst-actualteam\n#| lst-cap: team_top_scores() of actual team picks\nteam_names <- c(\"Brody Malone\", \"Fred Richard\", \"Asher Hong\", \"Paul Juda\",\n                \"Stephen Nedoroscik\")\nactual_team <- team_top_scores(team_names)\nactual_team_tot <- actual_team %>% \n  team_total()\nactual_team\n```\n\n### Interpreting the team's average scores\n\nThe expected team score for this team ^[with domestic judging]\nis `r actual_team_tot`.\nFor some context, the gold medal Japanese team at 2023 world championships\n^[according to the [wikipedia page](https://en.m.wikipedia.org/wiki/2023_World_Artistic_Gymnastics_Championships)]\nscored 255.594 and USA won bronze at the same competition with 252.428.\n\nOn paper this teams strengths relative to international competition seem to be\nFloor, Pommel, and High Bar with scores of \n`r actual_team %>% filter(Event==\"FX\") %>% pull(Score)`,\n`r actual_team %>% filter(Event==\"PH\") %>% pull(Score)`, and\n`r actual_team %>% filter(Event==\"HB\") %>% pull(Score)`,\nrespectively.\nHowever, the US is pretty infamous for not being able to pull together their \nfull potential on Pommel.\n\nThis team also remains competitive on  Rings with an average score of \n`r actual_team %>% filter(Event==\"SR\") %>% pull(Score)`\nand on P-Bars with a\n`r actual_team %>% filter(Event==\"PB\") %>% pull(Score)`.\nWith China being so dominant on those two events they probably won't win any\nevent final medals there but having those two events as strengths will definitely help the team score against Japan and Great Britain.\n\nIt's kind of surprising that the main weakness on paper of this team is vault.\nWith Brody, Paul, and Asher vaulting at a total predicted score of \n`r actual_team %>% filter(Event==\"VT\") %>% pull(Score)`,\nthey fall behind both China's and Great Britain's scores as well as the \nprevious US team's own score on the event from last year.\nI heard that judging on Asher's Ri Se Gwang vault seemed overly harsh,\nso it's possible that this team vault score gets better,\nbut I think he's the only one with a D-score higher than 5.6 on this event.\n\n### Potential vs Expectations\n\nThere will also be more psychological strain on these athletes which comes with\nthe media attention and unfamiliar setting in Paris.\nThis could be a factor that could potentially affect this team more than other\nalternative US teams.\n\nI was hoping that Yul Muldauer could provide the same kind of leadership\nhe showed at the World Championships to a younger and less-internationally \nexperienced team.\nUnfortunately he didn't perform up to his usual level of execution and \nconsistency in these past few competitions so I understand why he was left off.\nThese five guys (with maybe the exception of Paul?) have experience competing\nat the World/Olympic level, but I think Yul is one of those guys who gets along\nwith everyone and feels comfortable in the spotlight.\nI think Fred has a very similar enthusiasm and drive, but this is still only \nhis second year of competing at the senior international level.\n\nThe first night of the Olympic Trials made me pretty nervous about the \nability for US gymnasts to stay consistent with increased attention on them.\nIt was great to see how full the stadium in Minneapolis was for men's gymnastics,\nbut I also thought that some of the extra shakiness on Pommel and throughout the night might have been attributable to all the extra energy around.\nThis team has a lot of potential and I just hope that they don't get \noverwhelmed by the pressure of thinking that they need to live up to the \nhigh expectations of a domestic audience who only tune in every four years\nwith the anticipation that anything team USA touches at the Olympics could turn to gold.\n\n### Comparing to the rest of the field\n\n```{r}\n#| warning: false\n#| label: fig-eventdist_team\n#| fig-cap: \"Olympic team's scores relative to everyone else\"\nteam_scores <- indv.averages_df %>% \n    filter(NAME %in% team_names) %>%\n    select(-AA) %>% \n    pivot_longer(\n      -NAME,\n      names_to = \"Event\",\n      values_to = \"Score\",\n    )\neventsdist +\n  geom_vline(\n    data = team_scores, \n    aes(\n      xintercept = Score, \n      color = Score,\n      ),\n      linetype = \"dashed\"\n    ) +\n  geom_text(\n    data = team_scores, \n    aes(\n      y = 0.4,\n      x = Score,\n      label = NAME,\n      color = Score\n      ),\n    angle = 270,\n    size = 2,\n    nudge_x = 0.05,\n    ) +\n  scale_color_viridis_c(option = \"turbo\", direction = -1) +\n  xlim(12, 15)\n```\n\n---\n\n# Team Selection Analysis\n```{r}\n#| eval: false\n#| label: sim_results\n\nnames <- indv.averages_df %>% select(NAME) %>% pull()\n\n# all combinations of gymnasts choosing five at a time\nteams_possible <- combinat::combn(names, 5, simplify = T) %>% \n  as_tibble() %>% \n  pivot_longer(\n    cols = everything(),\n    names_to = \"team\",\n    values_to = \"name\") %>% \n  group_by(team) %>% \n  summarise(\n    names = list(name)\n  )\n\n# function to apply team_total to list of names\nteam_top_total <- function(x) team_total(team_top_scores(unlist(x)))\n\n# record top scores for every possible team combination\nteamsim_df <- teams_possible %>% \n  mutate(\n    total = as.numeric(map(names, team_top_total)),\n    # names = map(names, toString)\n  ) %>% \n  arrange(desc(total))\n\n# save sim results to file\nsave(teamsim_df, file = \"teamsim.RData\")\n```\n\n```{r specialist_rule}\nspecialist_rule <- function(teams, individuals) {\n  specialists <- individuals %>% \n    filter(is.na(AA)) %>% \n    select(NAME) %>% \n    pull()\n  teams %>% \n    filter(\n      str_count(.$names, paste(specialists, collapse='|')) < 2\n    )\n}\n```\n\n\n```{r}\n#| label: tbl-topteams\n#| tbl-cap: \"Top ten scoring teams on average\"\nload(\"./teamsim.RData\")\nteamsim_df %>% \n  select(-team) %>% \n  filter(str_detect(.$names, \"Patrick Hoopes\", negate = T)) %>% \n  specialist_rule(individuals = indv.averages_df) %>% \n  head(n=10)\n```\n\nIt's not surprising that Brody and Fred show up on all of these teams.\nAsher is also pretty dominant in this ranking, which seems to be coming from his\nhigher performances on rings and p-bars compared to Donnell and being close\nenough to Khoi on vault and floor.\n\nThe top team of all all-arounders just swaps out Stephen for Shane \nand scores more than a point lower.\nInteresting that Yul has a better all-around average than Asher, \nand yet he wouldn't actually the better pick in an all all-arounder team.\nA lot of these teams are just variations of the same teams except swapping \nStephen and Patrick Hoopes.\nBecause Stephen had a higher four-score average and potential difficulty \nthan Patrick, I drop Patrick from the list to get a sense of some more \nrealistic alternate team selections.\n\nThis also highlights how close Shane came to being on the team (by just .75)! \nBut it also how similar his contributions are to Paul's which sort of put him\nin the same unfortunate position as Patrick Hoopes who's status as a pommel \nspecialist means that he can only really be swapped out with Stephen.\n\n### Importance of Pommel Horse Specialists\n\nOne thing I didn't expect before seeing these simulated teams\nis that almost all of these top 20 teams have at least one pommel specialist\n(before I dropped Patrick).\n\n```{r}\n#| echo: true\nPH_actual_team <- actual_team %>% filter(Event==\"PH\") %>% \n  select(Score) %>% pull()\nPH_second_best <- indv.averages_df %>% \n  filter(!is.na(AA)) %>% \n  select(NAME, PH) %>% \n  slice_max(order_by = PH, n = 3)\nPH_second_best\n```\n\n```{r}\n#| echo: false\nPH_second_best_score <- PH_second_best %>% \n  summarise(x = sum(PH)) %>% \n  pull()\n```\n\nWithout sending a pommel horse specialist to Paris, \nthe best possible team score USA could put up on this event would be \n`r PH_second_best_score`.\nSo Stephen is contributing at least an extra \n`r PH_actual_team - PH_second_best_score` points to the team score\nand likely more considering that he's making sure Fred's 13.3 PH average \nwon't have to be counted. \n\n```{r}\n#| echo: false\npull_score <- function(scores, name, event) {\n  scores %>% \n    filter(NAME == name) %>% \n    select(event) %>% \n    pull()\n}\n```\n\nIf Khoi had hit his pommel routines consistently then he would have seemed\nlike a much more obvious replacement for Stephen because he has the potential\nto put up a 15.0 like he showed in night 2 of US Championships.\nHe would also make the team's vault score a lot more competitive where his \naverage score of \n`r pull_score(indv.averages_df, \"Khoi Young\", \"VT\")` is actually \n`r round(pull_score(indv.averages_df, \"Khoi Young\", \"VT\") - pull_score(indv.averages_df, \"Asher Hong\", \"VT\"), 1)*10`\ntenths higher than Asher's and seems to be a lot more consistent.\n\n# Other hypothetical compositions\n\n### Picking only the top all-arounders\n```{r}\n#| label: tbl-altteam1events\n#| tbl-cap: \"Top 5 all-arounders team event scores\"\n# If they had taken top five all arounders\nalt_team1_names <- indv.averages_df %>% \n  slice_head(n=5) %>% \n  select(NAME) %>% \n  pull()\nalt_team1 <- team_top_scores(alt_team1_names)\nalt_team1\n```\n\nThis team has an expected score of `r team_total(alt_team1)` \nwhich is `r round(actual_team_tot - team_total(alt_team1), digits=1)` points \nbehind the selected team's expected score,\nso it makes sense they didn't go with this team.\nPaul and Shane are both similar in that their main strengths are contributing \nsolid performances on any event but neither have any standout routines with\nenough difficulty to put them in event finals. \nIt makes sense to have one gymnast fill this roll on a team, \nbut I don't think it makes sense to leave behind world-class routines like \nStephen's pommel horse or Asher's, Khoi's, or Donnell's vaults to gain\nthe additional safe scores from sending both Paul and Shane together.\n\nIt was really cool to see how hyped the Minneapolis crowd was to see \nshane compete in his hometown and he did a great job over the two nights there,\nbut ultimately Paul just put on a more consistent performance during \nUS Championships. \nAnd that's what this type of role on team USA is all about;\njust proving that you will put up a decent score every time you go up.\n\n### My team picks\n```{r}\n#| label: tbl-altteam2events\n#| tbl-cap: \"My custom team's event breakdown\"\n# My own personal picks\nalt_team2_names <- c(\"Fred Richard\", \"Brody Malone\", \"Yul Moldauer\", \"Donnell Whittenburg\", \"Khoi Young\")\nalt_team2 <- team_top_scores(alt_team2_names)\nalt_team2\n```\n\nThis team falls short by `r round(actual_team_tot - team_total(alt_team2), 1)` points\nalthough I think they would have more opporunities to make event finals \non Floor, P-Bars, and Vault.\nGiven Donnell's vs Asher's performances over Nationals and Trials,\nit probably makes more sense to have Asher \nbut I think Donnell has more international experience \nand I also just really wanted to see him get to represent USA at the Olympics\nafter working so hard for his entire career and not really getting that much recognition.\n\n### Using Maximum Scores instead of Averages\n\n```{r}\nindv.max_df <- results_df %>% \n  filter(NAME %in% ot1_df$NAME) %>%  # who qualified to olympic trials \n  group_by(NAME) %>% \n  summarise_at(vars(FX:AA), max, na.rm=TRUE) %>% \n  arrange(desc(AA))\n\nteam_max_total <- function(x) team_total(team_top_scores(unlist(x), scores = indv.max_df))\n\n# record top scores for every possible team combination using individual max's\nteamsim_df <- teams_possible %>% \n  mutate(\n    total = as.numeric(map(names, team_max_total)),\n    # names = map(names, toString)\n  ) %>% \n  arrange(desc(total))\n\nteam_top_scores(teams_possible, scores = indv.max_df)\n```\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"kable","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"analysis.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.43","title":"2024 US Men's Gymnastics Olympic Team Selection","author":"Dante Yasui","date":"2024/06/29"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}